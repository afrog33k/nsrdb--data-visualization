const fs = require('fs');
const data143882 = require('./data/143882.json');
const data143883 = require('./data/143883.json');
const data143884 = require('./data/143884.json');
const data143885 = require('./data/143885.json');
const data143886 = require('./data/143886.json');
const data143887 = require('./data/143887.json');
const data143888 = require('./data/143888.json');
const data143889 = require('./data/143889.json');
const data143890 = require('./data/143890.json');
const data143891 = require('./data/143891.json');
const data143892 = require('./data/143892.json');
const data143893 = require('./data/143893.json');
const data143894 = require('./data/143894.json');
const data143895 = require('./data/143895.json');
const data143896 = require('./data/143896.json');
const data143897 = require('./data/143897.json');
const data143898 = require('./data/143898.json');
const data143899 = require('./data/143899.json');
const data143900 = require('./data/143900.json');
const data143901 = require('./data/143901.json');
const data143902 = require('./data/143902.json');
const data143903 = require('./data/143903.json');
const data144358 = require('./data/144358.json');
const data144359 = require('./data/144359.json');
const data144360 = require('./data/144360.json');
const data144361 = require('./data/144361.json');
const data144362 = require('./data/144362.json');
const data144363 = require('./data/144363.json');
const data144364 = require('./data/144364.json');
const data144365 = require('./data/144365.json');
const data144366 = require('./data/144366.json');
const data144367 = require('./data/144367.json');
const data144368 = require('./data/144368.json');
const data144369 = require('./data/144369.json');
const data144370 = require('./data/144370.json');
const data144371 = require('./data/144371.json');
const data144372 = require('./data/144372.json');
const data144373 = require('./data/144373.json');
const data144374 = require('./data/144374.json');
const data144375 = require('./data/144375.json');
const data144376 = require('./data/144376.json');
const data144377 = require('./data/144377.json');
const data144378 = require('./data/144378.json');
const data144379 = require('./data/144379.json');
const data144835 = require('./data/144835.json');
const data144836 = require('./data/144836.json');
const data144837 = require('./data/144837.json');
const data144838 = require('./data/144838.json');
const data144839 = require('./data/144839.json');
const data144840 = require('./data/144840.json');
const data144841 = require('./data/144841.json');
const data144842 = require('./data/144842.json');
const data144843 = require('./data/144843.json');
const data144844 = require('./data/144844.json');
const data144845 = require('./data/144845.json');
const data144846 = require('./data/144846.json');
const data144847 = require('./data/144847.json');
const data144848 = require('./data/144848.json');
const data144849 = require('./data/144849.json');
const data144850 = require('./data/144850.json');
const data144851 = require('./data/144851.json');
const data144852 = require('./data/144852.json');
const data144853 = require('./data/144853.json');
const data144854 = require('./data/144854.json');
const data144855 = require('./data/144855.json');
const data144856 = require('./data/144856.json');
const data145792 = require('./data/145792.json');
const data145793 = require('./data/145793.json');
const data145794 = require('./data/145794.json');
const data145795 = require('./data/145795.json');
const data145796 = require('./data/145796.json');
const data145797 = require('./data/145797.json');
const data145798 = require('./data/145798.json');
const data145799 = require('./data/145799.json');
const data145800 = require('./data/145800.json');
const data145801 = require('./data/145801.json');
const data145802 = require('./data/145802.json');
const data145803 = require('./data/145803.json');
const data145804 = require('./data/145804.json');
const data145805 = require('./data/145805.json');
const data145806 = require('./data/145806.json');
const data145807 = require('./data/145807.json');
const data145808 = require('./data/145808.json');
const data145809 = require('./data/145809.json');
const data145810 = require('./data/145810.json');
const data145811 = require('./data/145811.json');
const data145812 = require('./data/145812.json');
const data145813 = require('./data/145813.json');
const data146272 = require('./data/146272.json');
const data146273 = require('./data/146273.json');
const data146274 = require('./data/146274.json');
const data146275 = require('./data/146275.json');
const data146276 = require('./data/146276.json');
const data146277 = require('./data/146277.json');
const data146278 = require('./data/146278.json');
const data146279 = require('./data/146279.json');
const data146280 = require('./data/146280.json');
const data146281 = require('./data/146281.json');
const data146282 = require('./data/146282.json');
const data146283 = require('./data/146283.json');
const data146284 = require('./data/146284.json');
const data146285 = require('./data/146285.json');
const data146286 = require('./data/146286.json');
const data146287 = require('./data/146287.json');
const data146288 = require('./data/146288.json');
const data146289 = require('./data/146289.json');
const data146290 = require('./data/146290.json');
const data146291 = require('./data/146291.json');
const data146292 = require('./data/146292.json');
const data146293 = require('./data/146293.json');
const data147235 = require('./data/147235.json');
const data147236 = require('./data/147236.json');
const data147237 = require('./data/147237.json');
const data147238 = require('./data/147238.json');
const data147239 = require('./data/147239.json');
const data147240 = require('./data/147240.json');
const data147241 = require('./data/147241.json');
const data147242 = require('./data/147242.json');
const data147243 = require('./data/147243.json');
const data147244 = require('./data/147244.json');
const data147245 = require('./data/147245.json');
const data147246 = require('./data/147246.json');
const data147247 = require('./data/147247.json');
const data147248 = require('./data/147248.json');
const data147249 = require('./data/147249.json');
const data147250 = require('./data/147250.json');
const data147251 = require('./data/147251.json');
const data147252 = require('./data/147252.json');
const data147253 = require('./data/147253.json');
const data147254 = require('./data/147254.json');
const data147255 = require('./data/147255.json');
const data147256 = require('./data/147256.json');
const data147718 = require('./data/147718.json');
const data147719 = require('./data/147719.json');
const data147720 = require('./data/147720.json');
const data147721 = require('./data/147721.json');
const data147722 = require('./data/147722.json');
const data147723 = require('./data/147723.json');
const data147724 = require('./data/147724.json');
const data147725 = require('./data/147725.json');
const data147726 = require('./data/147726.json');
const data147727 = require('./data/147727.json');
const data147728 = require('./data/147728.json');
const data147729 = require('./data/147729.json');
const data147730 = require('./data/147730.json');
const data147731 = require('./data/147731.json');
const data147732 = require('./data/147732.json');
const data147733 = require('./data/147733.json');
const data147734 = require('./data/147734.json');
const data147735 = require('./data/147735.json');
const data147736 = require('./data/147736.json');
const data147737 = require('./data/147737.json');
const data147738 = require('./data/147738.json');
const data147739 = require('./data/147739.json');

const data145313 = require('./data/145313.json');
const data145314 = require('./data/145314.json');
const data145315 = require('./data/145315.json');
const data145316 = require('./data/145316.json');
const data145317 = require('./data/145317.json');
const data145318 = require('./data/145318.json');
const data145319 = require('./data/145319.json');
const data145320 = require('./data/145320.json');
const data145320 = require('./data/145320.json');
const data145321 = require('./data/145321.json');
const data145322 = require('./data/145322.json');
const data145323 = require('./data/145323.json');
const data145324 = require('./data/145324.json');
const data145325 = require('./data/145325.json');
const data145326 = require('./data/145326.json');
const data145327 = require('./data/145327.json');
const data145328 = require('./data/145328.json');
const data145329 = require('./data/145329.json');
const data145330 = require('./data/145330.json');
const data145331 = require('./data/145331.json');
const data145332 = require('./data/145332.json');
const data145333 = require('./data/145333.json');
const data145334 = require('./data/145334.json');







const allFiles = [data143882, data143883, data143884,
data143885, data143886, data143887, data143888, data143889, data143890, 
data143891, data143892, data143893, data143894, data143895, data143896, 
data143897, data143898, data143899, data143900, data143901, data143902, 
data143903, data144358, data144359, data144360, data144361, data144362, 
data144363, data144364, data144365, data144366, data144367, data144368, 
data144369, data144370, data144371, data144372, data144373, data144374, 
data144375, data144376, data144377, data144378, data144379, data144835,
data144836, data144837, data144838, data144839, data144840, data144841,
data144842, data144843, data144844, data144845, data144846, data144847,
data144848, data144849, data144850, data144851, data144852, data144853,
data144854, data144855, data144856, data145313, data145314, data145315,
data145316, data145317, data145318, data145319, data145320, data145321,
data145322, data145323, data145324, data145325, data145326, data145327,
data145328, data145329, data145330, data145331, data145332, data145333, 
data145334, data145792, data145793, data145794, 
data145795, data145796, data145797, data145798, data145799, data145800, 
data145801, data145802, data145803, data145804, data145805, data145806, 
data145807, data145808, data145809, data145810, data145811, data145812, 
data145813, data146272, data146273, data146274, data146275, data146276, 
data146277, data146278, data146279, data146280, data146281, data146282, 
data146283, data146284, data146285, data146286, data146287, 
data146288, data146289, data146290, data146291, data146292, data146293,
data147235, data147236, data147237, data147238, data147239, data147240, 
data147241, data147242, data147243, data147244, data147245, data147246, 
data147247, data147248, data147249, data147250, data147251, data147252, 
data147253, data147254, data147255, data147256, data147718, data147719, 
data147720, data147721, data147722, data147723, data147724, data147725, 
data147726, data147727, data147728, data147729, data147730, data147731, 
data147732, data147733, data147734, data147735, data147736, data147737, 
data147738, data147739]

const dataCleaner = (datasetInput) => {
  let dataset = datasetInput
  let infoObject = dataset.splice(0, 1)
  const timeArray = dataset.reduce((array, time) => {
    if (time.Month == 6 && time.Minute == 0 && time.Day == 21){
      array.push({
        Latitude: infoObject[0].Latitude,
        Longitude: infoObject[0].Longitude,
        Day: `2016-${time.Month}-${time.Day}`,
        Time: `${time.Hour}`,
        DNI: time.DNI
      })
    }
    return array
  }, [])
  return timeArray
}

const addFile = async (allFiles) => {
  const superCleanDataPromises = await allFiles.map(async file => {
    let data = await dataCleaner(file)
    return data
  })
  const superCleanData = await Promise.all(superCleanDataPromises)
  const solarData = JSON.stringify(superCleanData, null, ' ')
  fs.writeFile('./clean-data2.json', solarData, 'utf8', err => {
    if(err) {
      return console.log('write file error', err);
    }
  })
    console.log('data saved to clean-data file');
}

addFile(allFiles)